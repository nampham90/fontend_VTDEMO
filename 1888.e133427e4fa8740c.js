"use strict";(self.webpackChunkng_ant_admin=self.webpackChunkng_ant_admin||[]).push([[1888],{50308:(N,S,s)=>{s.d(S,{v:()=>x});var u=s(44556),f=s(94650),v=s(54246);let x=(()=>{class g{constructor(r){this.http=r}requestInit(r){return this.http.post(u.CommonAnt100RequestInt,r,{needSuccessInfo:!1})}listtaichinh(r){return this.http.post(u.CommonAnt100Listtaichinh,r,{needSuccessInfo:!1})}thongketaichinhnam(r){return this.http.post(u.CommonAnt100Thongketaichinhnam,r,{needSuccessInfo:!1})}tongchuyenhangtrongnam(r){return this.http.post(u.CommonAnt100Tongchuyenhangtrongnam,r,{needSuccessInfo:!1})}tongnoAll(r){return this.http.post(u.CommonAnt100Tongnoall,r,{needSuccessInfo:!1})}tongnoUser(r){return this.http.post(u.CommonAnt100Tongnouser,r,{needSuccessInfo:!1})}listtopdoanhthu(r){return this.http.post(u.CommonAnt100Listtopdoanhthu,r,{needSuccessInfo:!1})}listtopchiphi(r){return this.http.post(u.CommonAnt100Listtopchiphi,r,{needSuccessInfo:!1})}listtoptongcuoctungxe(r){return this.http.post(u.CommonAnt100Listtoptongcuoctungxe,r,{needSuccessInfo:!1})}Tinhtongnoxengoai(){return this.http.post(u.CommonAnt100Tongnoxengoai,{needSuccessInfo:!1})}getODS(){return this.http.post(u.CommonAnt100GetODS,{needSuccessInfo:!1})}getODT(){return this.http.post(u.CommonAnt100GetODT,{needSuccessInfo:!1})}getODC(){return this.http.post(u.CommonAnt100GetODC,{needSuccessInfo:!1})}getHDTTXN(){return this.http.post(u.CommonAnt100GetHDTTXN,{needSuccessInfo:!1})}getListSoID(r){return this.http.post(u.CommonAnt100GetListSoID,r,{needSuccessInfo:!1})}getListDichvuxecau(){return this.http.post(u.CommonAnt100GetListDichvuXeCau,{needSuccessInfo:!1})}getListDichvubocxep(){return this.http.post(u.CommonAnt100GetListDichvuBocXep,{needSuccessInfo:!1})}}return g.\u0275fac=function(r){return new(r||g)(f.LFG(v.q))},g.\u0275prov=f.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"}),g})()},71888:(N,S,s)=>{s.r(S),s.d(S,{Spkh00201Module:()=>it});var u=s(36895),f=s(9116),v=s(15861),x=s(22155),g=s(22195),y=s(13951),r=s(28746),C=s(44556),n=s(94650),F=s(91565),I=s(35568),Q=s(49651),Z=s(50007),U=s(60976),Y=s(79610),B=s(57087),G=s(99651),w=s(79213),P=s(32734),H=s(50308),d=s(24006),K=s(49523),A=s(39646),W=s(67859),E=s(85726),b=s(73679),m=s(36704),k=s(35635);const R=function(){return{minRows:2,maxRows:6}};let q=(()=>{class e{constructor(t,a,o,h){this.modalRef=t,this.fb=a,this.cdf=o,this.validatorsService=h,this.tiencuocMode=0}getAsyncFnData(t){return(0,A.of)(t)}getCurrentValue(){return(0,K.r7)(this.addEditForm)?(this.addEditForm.value.tiencuoc=this.tiencuocMode,(0,A.of)(this.addEditForm.value)):(0,A.of)(!1)}ngOnInit(){this.initForm(),Object.keys(this.params).length>0&&(this.tiencuocMode=this.params.tiencuoc)}initForm(){this.addEditForm=this.fb.group({lydo:[null,[d.kI.required]]})}changeTiencuoc(t){this.tiencuocMode=t}}return e.\u0275fac=function(t){return new(t||e)(n.Y36(Z.Lf),n.Y36(d.qu),n.Y36(n.sBO),n.Y36(W.S))},e.\u0275cmp=n.Xpm({type:e,selectors:[["app-spch00201subupdate-tiencuocxenha"]],decls:11,vars:12,consts:[["nz-form","",3,"formGroup"],["nzRequired","","nzFor","tiencuoc",3,"nzSm","nzXs"],["nzErrorTip","Vui l\xf2ng nh\u1eadp ...",3,"nzSm","nzXs"],[3,"Amount","changeAmount"],["nzRequired","","nzFor","lydo",3,"nzSm","nzXs"],["nzErrorTip","",3,"nzSm","nzXs"],["nz-input","","name","lydo","id","lydo","formControlName","lydo","placeholder","N\xeau l\xfd do thay \u0111\u1ed5i ti\u1ec1n c\u01b0\u1edbc.",3,"nzAutosize"]],template:function(t,a){1&t&&(n.TgZ(0,"form",0)(1,"nz-form-item")(2,"nz-form-label",1),n._uU(3,"Ti\u1ec1n c\u01b0\u1edbc"),n.qZA(),n.TgZ(4,"nz-form-control",2)(5,"app-input-currency",3),n.NdJ("changeAmount",function(h){return a.changeTiencuoc(h)}),n.qZA()()(),n.TgZ(6,"nz-form-item")(7,"nz-form-label",4),n._uU(8,"L\xfd do"),n.qZA(),n.TgZ(9,"nz-form-control",5),n._UZ(10,"textarea",6),n.qZA()()()),2&t&&(n.Q6J("formGroup",a.addEditForm),n.xp6(2),n.Q6J("nzSm",6)("nzXs",24),n.xp6(2),n.Q6J("nzSm",18)("nzXs",24),n.xp6(1),n.Q6J("Amount",a.tiencuocMode),n.xp6(2),n.Q6J("nzSm",6)("nzXs",24),n.xp6(2),n.Q6J("nzSm",18)("nzXs",24),n.xp6(1),n.Q6J("nzAutosize",n.DdM(11,R)))},dependencies:[d._Y,d.Fj,d.JJ,d.JL,d.sg,d.u,E.e,b.t3,b.SK,m.Lr,m.Nx,m.iK,m.Fd,k.Zp,k.rh]}),e})();var J=s(69174);let V=(()=>{class e{constructor(t){this.modalWrapService=t}getContentComponent(){return q}show(t={},a){return this.modalWrapService.show(this.getContentComponent(),t,a)}}return e.\u0275fac=function(t){return new(t||e)(n.LFG(J.U))},e.\u0275prov=n.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),j=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=n.Xpm({type:e,selectors:[["app-spch00201subupdate-tiencuocxengoai"]],decls:0,vars:0,template:function(t,a){}}),e})(),$=(()=>{class e{constructor(t){this.modalWrapService=t}getContentComponent(){return j}show(t={},a){return this.modalWrapService.show(this.getContentComponent(),t,a)}}return e.\u0275fac=function(t){return new(t||e)(n.LFG(J.U))},e.\u0275prov=n.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var nn=s(54246);let tn=(()=>{class e{constructor(t){this.http=t}updateTiencuocxenha(t){return this.http.post(C.Spch00201Ant100UpdateTiencuocxenha,t,{needSuccessInfo:!1})}updateTiencuocxengoai(t){return this.http.post(C.Spch00201Ant100UpdateTiencuocxengoai,t,{needSuccessInfo:!1})}}return e.\u0275fac=function(t){return new(t||e)(n.LFG(nn.q))},e.\u0275prov=n.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var en=s(94267),an=s(32802),on=s(5529),hn=s(35656),sn=s(94178),cn=s(21102),ln=s(66616),rn=s(47044),un=s(21811),pn=s(51971),L=s(48521),dn=s(834),gn=s(39597);const mn=["operationTpl"],fn=["tenhangTpl"],zn=["sotienTpl"],_n=["soluongTpl"],Tn=["donvitinhTpl"],Sn=["trangthaiTpl"],Cn=["nguonxeTpl"],bn=["khachhangTpl"],kn=["endSoplnDate"];function vn(e,i){if(1&e){const t=n.EpF();n.TgZ(0,"button",42),n.NdJ("click",function(){n.CHM(t);const o=n.oxw();return n.KtG(o.showVideo())}),n._UZ(1,"span",43),n._uU(2,"H\u01b0\u1edbng d\u1eabn "),n.qZA()}2&e&&n.Q6J("nzSize","large")}function xn(e,i){1&e&&(n._UZ(0,"span",44),n._uU(1," Quay l\u1ea1i"))}function yn(e,i){if(1&e){const t=n.EpF();n.TgZ(0,"button",45),n.NdJ("click",function(){n.CHM(t);const o=n.oxw();return n.KtG(o.searchKhachhangClick())}),n._UZ(1,"span",18),n.qZA()}2&e&&n.Q6J("nzType","primary")}function An(e,i){if(1&e){const t=n.EpF();n.TgZ(0,"span",49)(1,"button",50),n.NdJ("click",function(){n.CHM(t);const o=n.oxw(2),h=o.id,c=o.idphieunhaphang,l=o.status01,p=n.oxw();return n.KtG(p.capnhat(h,c,l))}),n._uU(2,"C\u1eadp nh\u1eadt"),n.qZA()()}2&e&&(n.xp6(1),n.Q6J("disabled",!0))}function Xn(e,i){if(1&e&&(n.ynx(0),n.YNc(1,An,3,1,"span",48),n.BQk()),2&e){const t=n.oxw(2);n.xp6(1),n.Q6J("appAuth",t.ActionCode.CtcnCapnhat)}}function Mn(e,i){if(1&e){const t=n.EpF();n.TgZ(0,"button",51),n.NdJ("click",function(){n.CHM(t);const o=n.oxw(),h=o.id,c=o.idphieunhaphang,l=o.status01,p=n.oxw();return n.KtG(p.capnhat(h,c,l))}),n._uU(1,"C\u1eadp nh\u1eadt"),n.qZA()}}function Dn(e,i){if(1&e){const t=n.EpF();n.TgZ(0,"button",51),n.NdJ("click",function(){n.CHM(t);const o=n.oxw(2).id,h=n.oxw();return n.KtG(h.duyetthanhtoan(o))}),n._uU(1,"Duy\u1ec7t"),n.qZA()}}function Zn(e,i){if(1&e&&(n.TgZ(0,"span",49),n.YNc(1,Dn,2,0,"button",52),n.qZA()),2&e){const t=n.oxw().showBtn;n.xp6(1),n.Q6J("ngIf",!t.btnduyet)}}function En(e,i){if(1&e&&(n.YNc(0,Xn,2,1,"ng-container",46),n.YNc(1,Mn,2,0,"ng-template",null,47,n.W1O),n.YNc(3,Zn,2,1,"span",48)),2&e){const t=i.chukyno,a=n.MAs(2),o=n.oxw();n.Q6J("ngIf",1==t)("ngIfElse",a),n.xp6(3),n.Q6J("appAuth",o.ActionCode.CtcnDuyetThanhtoan)}}function Jn(e,i){1&e&&(n.ynx(0),n._UZ(1,"nz-alert",54),n.BQk())}function Ln(e,i){1&e&&n._UZ(0,"nz-alert",55)}function On(e,i){if(1&e&&(n.YNc(0,Jn,2,0,"ng-container",46),n.YNc(1,Ln,1,0,"ng-template",null,53,n.W1O)),2&e){const t=i.chukyno,a=n.MAs(2);n.Q6J("ngIf",0==t)("ngIfElse",a)}}function Nn(e,i){if(1&e&&(n.ynx(0),n.TgZ(1,"span"),n._uU(2),n.qZA(),n.BQk()),2&e){const t=n.oxw().idphieunhaphang;n.xp6(2),n.Oqu(t.tenhang)}}function Fn(e,i){if(1&e&&(n.TgZ(0,"span"),n._uU(1),n.qZA()),2&e){const t=n.oxw().idphieunhaphang;n.xp6(1),n.Oqu(t.tenhang)}}function In(e,i){if(1&e&&(n.YNc(0,Nn,3,1,"ng-container",46),n.YNc(1,Fn,2,1,"ng-template",null,56,n.W1O)),2&e){const t=i.status01,a=n.MAs(2);n.Q6J("ngIf",""==t)("ngIfElse",a)}}function Qn(e,i){if(1&e&&(n.ynx(0),n.TgZ(1,"span"),n._uU(2),n.qZA(),n.BQk()),2&e){const t=n.oxw().idphieunhaphang;n.xp6(2),n.Oqu(t.biensoxe)}}function Un(e,i){if(1&e&&(n.TgZ(0,"span"),n._uU(1),n.qZA()),2&e){const t=n.oxw().idphieunhaphang;n.xp6(1),n.Oqu(t.nguonxe.datanm)}}function Yn(e,i){if(1&e&&(n.YNc(0,Qn,3,1,"ng-container",46),n.YNc(1,Un,2,1,"ng-template",null,56,n.W1O)),2&e){const t=i.status01,a=n.MAs(2);n.Q6J("ngIf",""==t)("ngIfElse",a)}}function Bn(e,i){if(1&e&&(n.TgZ(0,"span"),n._uU(1),n.qZA()),2&e){const t=i.idphieunhaphang;n.xp6(1),n.Oqu(t.soluong)}}function Gn(e,i){if(1&e&&(n.TgZ(0,"span"),n._uU(1),n.qZA()),2&e){const t=i.idphieunhaphang;n.xp6(1),n.Oqu(t.donvitinh)}}function wn(e,i){1&e&&n._UZ(0,"nz-alert",57),2&e&&n.s9C("nzMessage",i.iduser.name)}function Pn(e,i){if(1&e&&(n.TgZ(0,"span"),n._uU(1),n.ALo(2,"currency"),n.qZA()),2&e){const t=i.sotien;n.xp6(1),n.Oqu(n.xi3(2,1,1e3*t,"VND"))}}function Hn(e,i){if(1&e){const t=n.EpF();n.TgZ(0,"button",60),n.NdJ("click",function(){n.CHM(t);const o=n.oxw(2);return n.KtG(o.tattoan())}),n._UZ(1,"i",61),n._uU(2," T\u1ea5t to\xe1n "),n.qZA()}2&e&&n.Q6J("disabled",!0)}function Kn(e,i){if(1&e){const t=n.EpF();n.TgZ(0,"button",62),n.NdJ("click",function(){n.CHM(t);const o=n.oxw(2);return n.KtG(o.thanhtoanmotphan())}),n._UZ(1,"i",61),n._uU(2," Thanh to\xe1n "),n.qZA()}if(2&e){const t=n.oxw(2);n.Q6J("disabled",t.btnthanhtoanmotphan)}}function Wn(e,i){if(1&e&&(n.YNc(0,Hn,3,1,"button",58),n.YNc(1,Kn,3,1,"button",59)),2&e){const t=n.oxw();n.Q6J("appAuth",t.ActionCode.CtcnTattoan),n.xp6(1),n.Q6J("appAuth",t.ActionCode.CtcnThantoanmotphan)}}function Rn(e,i){if(1&e){const t=n.EpF();n.TgZ(0,"span",49)(1,"button",60),n.NdJ("click",function(){n.CHM(t);const o=n.oxw(3);return n.KtG(o.xuatpdf())}),n._UZ(2,"i",64),n._uU(3," Xu\u1ea5t PDF "),n.qZA()()}if(2&e){const t=n.oxw(3);n.xp6(1),n.Q6J("disabled",t.btnxuatpdf)}}function qn(e,i){if(1&e&&(n.ynx(0),n.YNc(1,Rn,4,1,"span",48),n.BQk()),2&e){const t=n.oxw(2);n.xp6(1),n.Q6J("appAuth",t.ActionCode.CtcnXuatPDF)}}function Vn(e,i){if(1&e&&n.YNc(0,qn,2,1,"ng-container",63),2&e){const t=n.oxw();n.Q6J("ngIf",t.showConfirm)}}const jn=function(){return{"padding-bottom":0}},X=function(){return{xs:8,sm:16,md:24}};class $n{constructor(){this.btnthanhtoan=!1,this.btnduyet=!1,this.disabledBtnthanhtoan=!1}}const nt=[{path:"",component:(()=>{class e extends y.H{constructor(t,a,o,h,c,l,p,z,_,ht,O,st,ct,lt,rt,ut,pt,dt){super(t,a,o,h,O,c),this.webService=t,this.router=a,this.cdf=o,this.datePipe=h,this.modalVideoyoutube=c,this.message=l,this.modalSrv=p,this.khdtoService=z,this.dataService=_,this.khachhangService=ht,this.tabService=O,this.pdfService=st,this.ctChuyenngoaiService=ct,this.commonService=lt,this.modalspch00201xenhaService=rt,this.modalspch00201xengoaiService=ut,this.spch00201Service=pt,this.spin00251subkhachhangService=dt,this.searchParam={},this.dateFormat=C.dateFormat,this.dataList=[],this.checkedCashArray=[],this.ActionCode=g.h,this.DisplayScreenID=x.t.spkh00201,this.availableOptions=[],this.pageHeaderInfo={title:"Chi ti\u1ebft c\xf4ng n\u1ee3",breadcrumb:["Home","Kh\xe1ch H\xe0ng","Chi ti\u1ebft c\xf4ng n\u1ee3"]},this.btnUpdate=!1,this.btnshowmodalkh=!1,this.btntattoan=!1,this.btnthanhtoanmotphan=!1,this.btnxuatpdf=!1,this.btnsearch=!1,this.idkhachhang="",this.tenkhachhang="",this.stocktenkhachhang="",this.sdtkhachhang="",this.diachikhachhang="",this.sotienno=0,this.soodc="",this.status="0",this.phanloai="N\u1ee3",this.disabledStartSoplnDate=T=>{if(!T||!this.ngayketthuc)return!1;const D=new Date(this.ngayketthuc);return T.getTime()>D.getTime()},this.disabledEndSoplnDate=T=>{if(!T||!this.ngaybatdau)return!1;const D=new Date(this.ngaybatdau);return T.getTime()<=D.getTime()},this.showConfirm=!0}fnInit(){this.cdf.markForCheck()}destroy(){}changeSotienno(t){this.sotienno=t}handleStartOpenSoplnChange(t){t||this.endSoplnDate.open()}handleEndOpenSoplnChange(t){}ngOnInit(){this.searchParam.ghichu="N\u1ee3",!1===this.khdtoService.kbnflg?(this.ngaybatdau=null,this.ngayketthuc=null,this.btnshowmodalkh=!1,this.idkhachhang="",this.tenkhachhang="",this.sdtkhachhang="",this.diachikhachhang="",this.sotienno=0,this.status="0",this.btntattoan=!0,this.btnthanhtoanmotphan=!0,this.btnsearch=!0):(this.btnshowmodalkh=!0,this.idkhachhang=this.khdtoService.id,this.tenkhachhang=this.khdtoService.name,this.sotienno=this.khdtoService.sotienno,this.sdtkhachhang=this.khdtoService.dienthoai,this.diachikhachhang=this.khdtoService.diachi,this.status="0",this.btntattoan=!1,this.btnthanhtoanmotphan=!0,this.btnsearch=!1),this.initTable(),this.cdf.markForCheck()}getDataList(t){this.tableLoading(!0),this.searchParam.ngaybatdau=this.formatDate(this.ngaybatdau),this.searchParam.ngayketthuc=this.formatDate(this.ngayketthuc),this.dataService.getlists({pageSize:this.tableConfig.pageSize,pageNum:t?.pageIndex||this.tableConfig.pageIndex,filters:this.searchParam}).pipe((0,r.x)(()=>{this.tableLoading(!1)})).subscribe(o=>{const{list:h,total:c,pageNum:l}=o;this.dataList=[...h];for(let p of this.dataList){let z=this.showBtnTable(p.trangthai);p.showBtn=z,"\u0110\xe3 thanh to\xe1n"==p.ghichu&&(p.showBtn.disabledBtnthanhtoan=!0)}this.tableConfig.total=c,this.tableConfig.pageIndex=l,this.tableLoading(!1),this.checkedCashArray=[...this.checkedCashArray],this.showbtn()})}showbtn(){this.dataList.length>0?(this.btntattoan=!1,this.btnthanhtoanmotphan=!1):(this.btntattoan=!0,this.btnthanhtoanmotphan=!0);let t=!1;for(let a of this.dataList)if(""!=a.status05){t=!0;break}this.btnxuatpdf=1==t}showBtnTable(t){let a=new $n;switch(t){case 0:a.btnthanhtoan=!1,a.btnduyet=!0;break;case 1:a.btnthanhtoan=!0,a.btnduyet=!1;break;case 2:a.btnduyet=!0,a.btnthanhtoan=!0}return a}thanhtoan(t,a){this.modalSrv.confirm({nzTitle:"B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n thanh to\xe1n \u0111\u01a1n h\xe0ng n\xe0y?",nzContent:"Nh\u1ea5n OK \u0111\u1ec3 ho\xe0n th\xe0nh",nzOnOk:()=>{let o={};o=t?{iduser:this.khdtoService.id,idphieunhaphang:t._id}:{iduser:this.khdtoService.id,status01:a},this.tableConfig.loading=!0,this.dataService.thanhtoan(o).pipe((0,r.x)(()=>{this.tableLoading(!1)})).subscribe(h=>{1==h?(this.message.info("Thanh To\xe1n th\xe0nh c\xf4ng !"),this.getDetailKhachhang()):this.message.info(" Ph\xe1t sinh l\u1ed7i trong qu\xe1 tr\xecnh thanh to\xe1n"),this.getDataList(),this.tableLoading(!1)})}})}capnhat(t,a,o){""==o?this.modalspch00201xenhaService.show({nzTitle:"C\u1eadp nh\u1eadt ti\u1ec1n c\u01b0\u1edbc"},{tiencuoc:a.tiencuoc}).subscribe(h=>{if(!h||0===h.status)return;const c={...h.modalValue};c.tiencuoc!=a.tiencuoc?this.spch00201Service.updateTiencuocxenha({soID:a.soID,idNhatkykh:t,tiencuocupdate:c.tiencuoc,lydo:c.lydo}).subscribe(p=>{console.log(p),1==p&&(this.message.success("Th\u1ef1c hi\u1ec7n th\xe0nh c\xf4ng !"),this.getDataList())}):this.modalSrv.info({nzTitle:"B\u1ea1n ch\u01b0a thay \u0111\u1ed5i ti\u1ec1n c\u01b0\u1edbc !"})}):this.modalspch00201xenhaService.show({nzTitle:"C\u1eadp nh\u1eadt ti\u1ec1n c\u01b0\u1edbc"},{tiencuoc:a.tiencuoc}).subscribe(h=>{if(!h||0===h.status)return;const c={...h.modalValue};c.tiencuoc!=a.tiencuoc?this.spch00201Service.updateTiencuocxengoai({idNhatkykh:t,idchuyenngoai:a.idchuyenngoai,sdtnguoinhan:a.sdtnguoinhan,tenhang:a.tenhang,tiencuoc:a.tiencuoc,tiencuocupdate:c.tiencuoc,lydo:c.lydo}).subscribe(p=>{console.log(p),1==p&&(this.message.success("Th\u1ef1c hi\u1ec7n th\xe0nh c\xf4ng !"),this.getDataList())}):this.modalSrv.info({nzTitle:"B\u1ea1n ch\u01b0a thay \u0111\u1ed5i ti\u1ec1n c\u01b0\u1edbc !"})})}duyetthanhtoan(t){}tattoan(){this.modalSrv.confirm({nzTitle:"B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n T\u1ea5t to\xe1n?",nzContent:"Nh\u1ea5n OK \u0111\u1ec3 ho\xe0n th\xe0nh",nzOnOk:()=>{this.tableLoading(!0),this.dataService.tatToan({iduser:this.khdtoService.id,sotientra:this.khdtoService.sotienno}).pipe().subscribe(()=>{this.getDetailKhachhang(),this.getDataList(),this.resetForm()},a=>this.tableLoading(!1))}})}getDetailKhachhang(){this.khachhangService.getDetail(this.khdtoService.id).pipe().subscribe(t=>{this.sotienno=t.sotienno,this.khdtoService.sotienno=t.sotienno})}thanhtoanmotphan(){if(""==this.searchParam.iduser||null==this.searchParam.iduser||null==this.searchParam.iduser)return void this.modalSrv.info({nzTitle:"Vui l\xf2ng Ch\u1ecdn kh\xe1ch hang c\u1ea7n thanh to\xe1n !"});if(""==this.searchParam.status05||null==this.searchParam.status05||null==this.searchParam.status05)return void this.modalSrv.info({nzTitle:"Vui l\xf2ng ch\u1ecdn s\u1ed1 ODC c\u1ea7n thanh to\xe1n v\xe0 ch\u1ecdn t\xecm ki\u1ebfm !"});let t=[],a=!1,o=!1;for(let c of this.dataList){if(1==c._checked&&(t.push(c.idphieunhaphang.idchuyen?c.idphieunhaphang._id:c.status01),c.status05!=this.searchParam.status05)){o=!0;break}if(""==c.status05){a=!0;break}}0!=t.length?!0!==o?!0!==a?this.modalSrv.confirm({nzTitle:"B\u1ea1n c\xf3 ch\u1eafc ch\u1eafn mu\u1ed1n thanh to\xe1n kh\xf4ng ?",nzContent:"Nh\u1ea5n OK \u0111\u1ec3 ho\xe0n th\xe0nh vi\u1ec7c thanh to\xe1n",nzOnOk:()=>{let c={iduser:this.searchParam.iduser,listidpn:t,soodc:this.searchParam.status05};this.tableLoading(!0),this.dataService.thanhtoanmotphan(c).pipe((0,r.x)(()=>{this.tableLoading(!1)})).subscribe(l=>{1==l?(this.message.info("Th\u1ef1c hi\u1ec7n th\xe0nh c\xf4ng !"),this.getDetailKhachhang()):this.message.info(l.msgError),this.getDataList(),this.tableLoading(!1)})}}):this.modalSrv.info({nzTitle:"Vui l\xf2ng xu\xe2t file pdf \u0111\u1ec3 tao S\u1ed1 ODC. m\u1edbi b\u1eaft \u0111\u1ea7u thanh to\xe1n"}):this.modalSrv.info({nzTitle:"D\u1eed li\u1ec7u b\u1ea1n ch\u1ecdn kh\xf4ng tr\xf9ng kh\u1edbp !"}):this.modalSrv.info({nzTitle:"V\xf9i l\xf2ng t\xedch v\xe0o \u0111\u01a1n h\xe0ng !"})}resetForm(){this.searchParam={},this.tenkhachhang="",this.searchParam.ghichu="N\u1ee3"}fnFocusOutKhachhang(){this.searchParam.iduser!=this.stocktenkhachhang&&(this.tenkhachhang="")}searchKhachhangClick(){this.spin00251subkhachhangService.show({nzTitle:"Danh s\xe1ch kh\xe1ch h\xe0ng"},{showcomfirm:!1}).subscribe(t=>{if(!t||0===t.status)return;const a={...t.modalValue};this.searchParam.iduser=a.id,this.idkhachhang=a.id,this.stocktenkhachhang=a.id,this.tenkhachhang=a.name,this.commonService.tongnoUser({iduser:a.id}).subscribe(o=>{this.sotienno=o,this.cdf.detectChanges()})})}reloadTable(){this.message.info("\u0110\xe3 \u0111\u01b0\u1ee3c l\xe0m m\u1edbi"),this.getDataList()}tableChangeDectction(){this.dataList=[...this.dataList],this.cdf.detectChanges()}tableLoading(t){this.tableConfig.loading=t,this.tableChangeDectction()}selectedChecked(t){this.checkedCashArray=[...t]}changePageSize(t){this.tableConfig.pageSize=t}initTable(){this.tableConfig={showCheckbox:!0,headers:[{title:"S\u1ed1 ODC",width:200,field:"status05"},{title:"Kh\xe1ch h\xe0ng",width:200,field:"khachhang",tdTemplate:this.khachhangTpl},{title:"N\u1ed9i dung \u0111\u01a1n h\xe0ng",width:450,field:"idphieunhaphang",tdTemplate:this.tenhangTpl},{title:"S\u1ed1 ti\u1ec1n",width:120,field:"sotien",tdTemplate:this.sotienTpl},{title:"Trang Th\xe1i",width:180,field:"trangthai",tdTemplate:this.trangthaiTpl},{title:"S\u1ed1 l\u01b0\u1ee3ng",width:120,field:"soluong",tdTemplate:this.soluongTpl},{title:"\u0110\u01a1n v\u1ecb t\xednh",width:120,field:"donvitinh",tdTemplate:this.donvitinhTpl},{title:"Ngu\u1ed3n xe",width:250,field:"nguonxe",tdTemplate:this.nguonxeTpl},{title:"Ng\xe0y",field:"ngay",width:150,pipe:"date:yyyy-MM-dd HH:mm"},{title:"Ghi ch\xfa",width:150,field:"ghichu"},{title:"H\xe0nh \u0111\u1ed9ng",tdTemplate:this.operationTpl,width:250,fixed:!0,fixedDir:"right"}],total:0,loading:!0,pageSize:10,pageIndex:1}}generateData(){let t=[];for(let a of this.dataList)if(1==a._checked){let o="";o=a.idphieunhaphang.tenhang;let h=[this.formatDate(a.ngay),o,this.displayVND(a.sotien)];t.push(h)}return t}xuatpdf(){var t=this;this.generateData().length>0?this.commonService.getODC().pipe().subscribe(function(){var a=(0,v.Z)(function*(o){let h="C\xf4ng n\u1ee3 "+t.tenkhachhang;t.pdfService.clearHeader();let l=C.headerLayout;l[0].field="K\xednh g\u1eedi:",l[0].value=t.tenkhachhang,l[1].field="S\u1ed1 \u0111i\u1ec7n tho\u1ea1i:",l[1].value=t.sdtkhachhang,l[2].field="\u0110\u1ecba ch\u1ec9:",l[2].value=t.diachikhachhang,l[3].field="T\u1ed5ng ti\u1ec1n thanh to\xe1n:",l[3].value=t.displayVND(t.fnTongCuoc()),l[4].field="S\u1ed1 ODC:",l[4].value=t.displayOD(o),yield t.pdfService.exportPDF([["Ng\xe0y V\u1eadn Chuy\u1ec3n","Th\xf4ng Tin \u0110\u01a1n H\xe0ng","Ti\u1ec1n c\u01b0\u1edbc"]],l,t.generateData(),h,t.getDate(),"B\xean thanh to\xe1n","B\xean V\u1eadn Chuy\u1ec3n",o);let p=[];for(let _ of t.dataList)p.push(_.id);let z={lstId:p,soodc:o,idkhachhang:t.idkhachhang,tongcuoc:t.fnTongCuoc()};t.dataService.UpdateStauts05(z).pipe().subscribe(_=>{1==_&&(t.modalSrv.info({nzTitle:"C\u1eadp nh\u1eadt th\xe0nh c\xf4ng !"}),t.getDataList())})});return function(o){return a.apply(this,arguments)}}()):this.modalSrv.info({nzTitle:"V\xf9i ch\u1ecdn \xedt nh\u1ea5t m\u1ed9t \u0111\u01a1n h\xe0ng \u0111\u1ec3 xu\u1ea5t c\u1ed9ng n\u1ee3"})}fnTongCuoc(){let t=0;for(let a of this.dataList)t+=a.sotien;return t}fnGetIddonhang(t){return t.substring(0,24)}}return e.\u0275fac=function(t){return new(t||e)(n.Y36(F.Q),n.Y36(f.F0),n.Y36(n.sBO),n.Y36(u.uU),n.Y36(I.L),n.Y36(Q.dD),n.Y36(Z.Sf),n.Y36(U.k),n.Y36(Y.t),n.Y36(B.T),n.Y36(G.p),n.Y36(w.j),n.Y36(P.R),n.Y36(H.v),n.Y36(V),n.Y36($),n.Y36(tn),n.Y36(en.a))},e.\u0275cmp=n.Xpm({type:e,selectors:[["app-spkh00201"]],viewQuery:function(t,a){if(1&t&&(n.Gf(mn,7),n.Gf(fn,7),n.Gf(zn,7),n.Gf(_n,7),n.Gf(Tn,7),n.Gf(Sn,7),n.Gf(Cn,7),n.Gf(bn,7),n.Gf(kn,5)),2&t){let o;n.iGM(o=n.CRH())&&(a.operationTpl=o.first),n.iGM(o=n.CRH())&&(a.tenhangTpl=o.first),n.iGM(o=n.CRH())&&(a.sotienTpl=o.first),n.iGM(o=n.CRH())&&(a.soluongTpl=o.first),n.iGM(o=n.CRH())&&(a.donvitinhTpl=o.first),n.iGM(o=n.CRH())&&(a.trangthaiTpl=o.first),n.iGM(o=n.CRH())&&(a.nguonxeTpl=o.first),n.iGM(o=n.CRH())&&(a.khachhangTpl=o.first),n.iGM(o=n.CRH())&&(a.endSoplnDate=o.first)}},features:[n.qOj],decls:88,vars:150,consts:[[3,"backTpl","extraTpl","backUrl","pageHeaderInfo"],["huongdanTpl",""],["backTpl",""],[1,"normal-table-wrap"],["nzHoverable","",1,"m-b-10",3,"nzBodyStyle"],["nz-form",""],["nz-row","",3,"nzGutter"],["nz-col","",1,"inputIcon",3,"nzXXl","nzXl","nzLg","nzMd","nzSm","nzXs"],[3,"nzXXl","nzXl","nzLg","nzMd","nzSm","nzXs"],["nzSearch","",3,"nzAddOnAfter"],["name","iduser","type","text","nz-input","","placeholder","","readonly","",3,"ngModel","ngModelChange","blur"],["suffixIconButtonKhachhang",""],["nzFor","",1,"fix-inputIcon",3,"nzNoColon"],["nz-col","",3,"nzXXl","nzXl","nzLg","nzMd","nzSm","nzXs"],[3,"nzXXl","nzXl","nzLg","nzMd","nzSm","nzXs","nzFor"],[3,"Amount","Disable","changeAmount"],["nz-col","",1,"text-right","p-0","m-b-10",3,"nzXXl","nzXl","nzLg","nzMd","nzSm","nzXs"],["nz-button","",3,"nzType","click"],["nz-icon","","nzType","search"],["nz-button","",1,"m-l-15",3,"click"],["nz-icon","","nzType","close-circle","nzTheme","outline"],["nzRequired","",3,"nzXXl","nzXl","nzLg","nzMd","nzSm","nzXs","nzFor"],["name","ngaybatdau",3,"nzDisabledDate","nzFormat","ngModel","nzPlaceHolder","ngModelChange","nzOnOpenChange"],["name","ngayketthuc",3,"nzDisabledDate","nzFormat","ngModel","nzPlaceHolder","ngModelChange","nzOnOpenChange"],["endSoplnDate",""],[3,"nzXXl","nzXl","nzLg","nzMd","nzSm","nzXs","nzErrorTip"],["nz-input","","name","status05","id","status05","placeholder","",3,"ngModel","ngModelChange"],["id","ghichu","name","ghichu",3,"ngModel","ngModelChange"],["nz-radio","","nzValue","N\u1ee3"],["nz-radio","","nzValue","\u0110\xe3 thanh to\xe1n"],[3,"tableTitle","btnTpl","btnConfirm","reload"],[3,"checkedCashArrayFromComment","tableConfig","tableData","selectedChange","changePageSize","changePageNum"],["operationTpl",""],["trangthaiTpl",""],["tenhangTpl",""],["nguonxeTpl",""],["soluongTpl",""],["donvitinhTpl",""],["khachhangTpl",""],["sotienTpl",""],["tableBtns",""],["tableConfirm",""],["nz-button","","nzType","primary","nzShape","round",3,"nzSize","click"],["nz-icon","","nzType","star","nzTheme","outline"],["nz-icon","","nzType","arrow-left","nzTheme","outline"],["nz-button","",1,"bg-icon",3,"nzType","click"],[4,"ngIf","ngIfElse"],["ShowUpdate",""],["class","operate-text",4,"appAuth"],[1,"operate-text"],["nz-button","","nzType","primary","nzGhost","",3,"disabled","click"],["nz-button","","nzType","primary","nzGhost","",3,"click"],["nz-button","","nzType","primary","nzGhost","",3,"click",4,"ngIf"],["BlockTemplate",""],["nzType","warning","nzMessage","Ch\u01b0a Thanh To\xe1n","nzShowIcon",""],["nzType","success","nzMessage","\u0110\xe3 thanh to\xe1n","nzShowIcon",""],["Block",""],["nzType","success",3,"nzMessage"],["nz-button","","nzType","primary","class","m-r-8",3,"disabled","click",4,"appAuth"],["nz-button","","nzType","default",3,"disabled","click",4,"appAuth"],["nz-button","","nzType","primary",1,"m-r-8",3,"disabled","click"],["nz-icon","","nzType","money-collect","nzTheme","twotone"],["nz-button","","nzType","default",3,"disabled","click"],[4,"ngIf"],["nz-icon","","nzType","caret-right"]],template:function(t,a){if(1&t&&(n._UZ(0,"app-page-header",0),n.YNc(1,vn,3,1,"ng-template",null,1,n.W1O),n.YNc(3,xn,2,0,"ng-template",null,2,n.W1O),n.TgZ(5,"div",3)(6,"nz-card",4)(7,"form",5)(8,"div",6)(9,"div",7)(10,"nz-form-item")(11,"nz-form-label",8),n._uU(12,"M\xe3 kh\xe1ch h\xe0ng"),n.qZA(),n.TgZ(13,"nz-form-control",8)(14,"nz-input-group",9)(15,"input",10),n.NdJ("ngModelChange",function(h){return a.searchParam.iduser=h})("blur",function(){return a.fnFocusOutKhachhang()}),n.qZA()(),n.YNc(16,yn,2,1,"ng-template",null,11,n.W1O),n.TgZ(18,"nz-form-label",12)(19,"span")(20,"u"),n._uU(21),n.qZA()()()()()(),n.TgZ(22,"div",13)(23,"nz-form-item")(24,"nz-form-label",14),n._uU(25,"S\u1ed1 ti\u1ec1n n\u1ee3"),n.qZA(),n.TgZ(26,"nz-form-control",8)(27,"app-input-currency",15),n.NdJ("changeAmount",function(h){return a.changeSotienno(h)}),n.qZA()()()(),n.TgZ(28,"div",16)(29,"button",17),n.NdJ("click",function(){return a.getDataList()}),n._UZ(30,"i",18),n._uU(31," T\xecm ki\u1ebfm "),n.qZA(),n.TgZ(32,"button",19),n.NdJ("click",function(){return a.resetForm()}),n._UZ(33,"i",20),n._uU(34," L\xe0m m\u1edbi "),n.qZA()()(),n.TgZ(35,"div",6)(36,"div",13)(37,"nz-form-item")(38,"nz-form-label",21),n._uU(39,"Ng\xe0y b\u1eaft \u0111\u1ea7u"),n.qZA(),n.TgZ(40,"nz-form-control",8)(41,"nz-date-picker",22),n.NdJ("ngModelChange",function(h){return a.ngaybatdau=h})("nzOnOpenChange",function(h){return a.handleStartOpenSoplnChange(h)}),n.qZA()()()(),n.TgZ(42,"div",13)(43,"nz-form-item")(44,"nz-form-label",14),n._uU(45,"Ng\xe0y k\u1ebft th\xfac"),n.qZA(),n.TgZ(46,"nz-form-control",8)(47,"nz-date-picker",23,24),n.NdJ("ngModelChange",function(h){return a.ngayketthuc=h})("nzOnOpenChange",function(h){return a.handleEndOpenSoplnChange(h)}),n.qZA()()()()(),n.TgZ(49,"div",6)(50,"div",13)(51,"nz-form-item")(52,"nz-form-label",14),n._uU(53,"S\u1ed1 ODC"),n.qZA(),n.TgZ(54,"nz-form-control",25)(55,"input",26),n.NdJ("ngModelChange",function(h){return a.searchParam.status05=h}),n.qZA()()()(),n.TgZ(56,"div",13)(57,"nz-form-item")(58,"nz-form-label",8),n._uU(59,"Ph\xe2n lo\u1ea1i"),n.qZA(),n.TgZ(60,"nz-form-control",8)(61,"nz-radio-group",27),n.NdJ("ngModelChange",function(h){return a.searchParam.ghichu=h}),n.TgZ(62,"label",28),n._uU(63,"N\u1ee3 "),n.qZA(),n.TgZ(64,"label",29),n._uU(65,"\u0110\xe3 thanh to\xe1n"),n.qZA()()()()()()()(),n.TgZ(66,"app-card-table-wrap",30),n.NdJ("reload",function(){return a.reloadTable()}),n.TgZ(67,"app-ant-table",31),n.NdJ("selectedChange",function(h){return a.selectedChecked(h)})("changePageSize",function(h){return a.changePageSize(h)})("changePageNum",function(h){return a.getDataList(h)}),n.qZA(),n.YNc(68,En,4,3,"ng-template",null,32,n.W1O),n.YNc(70,On,3,2,"ng-template",null,33,n.W1O),n.YNc(72,In,3,2,"ng-template",null,34,n.W1O),n.YNc(74,Yn,3,2,"ng-template",null,35,n.W1O),n.YNc(76,Bn,2,1,"ng-template",null,36,n.W1O),n.YNc(78,Gn,2,1,"ng-template",null,37,n.W1O),n.YNc(80,wn,1,1,"ng-template",null,38,n.W1O),n.YNc(82,Pn,3,4,"ng-template",null,39,n.W1O),n.qZA(),n.YNc(84,Wn,2,2,"ng-template",null,40,n.W1O),n.YNc(86,Vn,1,1,"ng-template",null,41,n.W1O),n.qZA()),2&t){const o=n.MAs(2),h=n.MAs(4),c=n.MAs(17),l=n.MAs(85),p=n.MAs(87);n.Q6J("backTpl",h)("extraTpl",o)("backUrl","/default/khachhang/spkh00101")("pageHeaderInfo",a.pageHeaderInfo),n.xp6(6),n.Q6J("nzBodyStyle",n.DdM(146,jn)),n.xp6(2),n.Q6J("nzGutter",n.DdM(147,X)),n.xp6(1),n.Q6J("nzXXl",8)("nzXl",8)("nzLg",8)("nzMd",12)("nzSm",24)("nzXs",24),n.xp6(2),n.Q6J("nzXXl",9)("nzXl",9)("nzLg",9)("nzMd",12)("nzSm",24)("nzXs",24),n.xp6(2),n.Q6J("nzXXl",10)("nzXl",10)("nzLg",10)("nzMd",10)("nzSm",20)("nzXs",24),n.xp6(1),n.Q6J("nzAddOnAfter",c),n.xp6(1),n.Q6J("ngModel",a.searchParam.iduser),n.xp6(3),n.Q6J("nzNoColon",!0),n.xp6(3),n.Oqu(a.tenkhachhang),n.xp6(1),n.Q6J("nzXXl",8)("nzXl",8)("nzLg",8)("nzMd",12)("nzSm",24)("nzXs",24),n.xp6(2),n.Q6J("nzXXl",9)("nzXl",9)("nzLg",9)("nzMd",12)("nzSm",24)("nzXs",24),n.xp6(2),n.Q6J("nzXXl",10)("nzXl",10)("nzLg",10)("nzMd",10)("nzSm",20)("nzXs",24),n.xp6(1),n.Q6J("Amount",a.sotienno)("Disable",!0),n.xp6(1),n.Q6J("nzXXl",8)("nzXl",8)("nzLg",8)("nzMd",12)("nzSm",24)("nzXs",24),n.xp6(1),n.Q6J("nzType","primary"),n.xp6(6),n.Q6J("nzGutter",n.DdM(148,X)),n.xp6(1),n.Q6J("nzXXl",8)("nzXl",8)("nzLg",8)("nzMd",12)("nzSm",24)("nzXs",24),n.xp6(2),n.Q6J("nzXXl",9)("nzXl",9)("nzLg",9)("nzMd",12)("nzSm",24)("nzXs",24),n.xp6(2),n.Q6J("nzXXl",12)("nzXl",12)("nzLg",12)("nzMd",12)("nzSm",24)("nzXs",24),n.xp6(1),n.Q6J("nzDisabledDate",a.disabledStartSoplnDate)("nzFormat",a.dateFormat)("ngModel",a.ngaybatdau)("nzPlaceHolder",a.dateFormat),n.xp6(1),n.Q6J("nzXXl",8)("nzXl",8)("nzLg",8)("nzMd",12)("nzSm",24)("nzXs",24),n.xp6(2),n.Q6J("nzXXl",9)("nzXl",9)("nzLg",9)("nzMd",12)("nzSm",24)("nzXs",24),n.xp6(2),n.Q6J("nzXXl",12)("nzXl",12)("nzLg",12)("nzMd",12)("nzSm",24)("nzXs",24),n.xp6(1),n.Q6J("nzDisabledDate",a.disabledEndSoplnDate)("nzFormat",a.dateFormat)("ngModel",a.ngayketthuc)("nzPlaceHolder",a.dateFormat),n.xp6(2),n.Q6J("nzGutter",n.DdM(149,X)),n.xp6(1),n.Q6J("nzXXl",8)("nzXl",8)("nzLg",8)("nzMd",12)("nzSm",24)("nzXs",24),n.xp6(2),n.Q6J("nzXXl",9)("nzXl",9)("nzLg",9)("nzMd",12)("nzSm",24)("nzXs",24),n.xp6(2),n.Q6J("nzXXl",12)("nzXl",12)("nzLg",12)("nzMd",12)("nzSm",24)("nzXs",24)("nzErrorTip",""),n.xp6(1),n.Q6J("ngModel",a.searchParam.status05),n.xp6(1),n.Q6J("nzXXl",8)("nzXl",8)("nzLg",8)("nzMd",12)("nzSm",24)("nzXs",24),n.xp6(2),n.Q6J("nzXXl",9)("nzXl",9)("nzLg",9)("nzMd",12)("nzSm",24)("nzXs",24),n.xp6(2),n.Q6J("nzXXl",15)("nzXl",15)("nzLg",15)("nzMd",15)("nzSm",24)("nzXs",24),n.xp6(1),n.Q6J("ngModel",a.searchParam.ghichu),n.xp6(5),n.Q6J("tableTitle","K\u1ebft qu\u1ea3 t\xecm ki\u1ebfm")("btnTpl",l)("btnConfirm",p),n.xp6(1),n.Q6J("checkedCashArrayFromComment",a.checkedCashArray)("tableConfig",a.tableConfig)("tableData",a.dataList)}},dependencies:[u.O5,d._Y,d.Fj,d.JJ,d.JL,d.On,d.F,an.q,on.q,E.e,hn.x,sn.p,cn.Ls,b.t3,b.SK,m.Lr,m.Nx,m.iK,m.Fd,ln.ix,rn.w,un.dQ,k.Zp,k.gB,pn.bd,L.Of,L.Dg,dn.uw,gn.r,u.H9],changeDetection:0}),e})(),data:{title:"Thanh to\xe1n c\xf4ng n\u1ee3",key:"spkh00201"}}];let tt=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=n.oAB({type:e}),e.\u0275inj=n.cJS({imports:[f.Bz.forChild(nt),f.Bz]}),e})();var M=s(5316),et=s(30804);let at=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=n.oAB({type:e}),e.\u0275inj=n.cJS({imports:[M.m]}),e})(),ot=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=n.oAB({type:e}),e.\u0275inj=n.cJS({imports:[M.m]}),e})(),it=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=n.oAB({type:e}),e.\u0275inj=n.cJS({imports:[u.ez,tt,M.m,et.A,at,ot]}),e})()}}]);